// Generated by CoffeeScript 1.3.3

$(function() {
  var block, codeblocks, collapse, expand, keep, numlines, prepareblock, _i, _len;
  keep = 10;
  prepareblock = function(block) {
    block.addClass('collapsable');
    collapse(keep, block);
    block.append($("<li/>").text("...").addClass("ellipsis"));
  };
  numlines = function(block) {
    var lines;
    lines = $('ol.linenums li', block);
    return lines.size();
  };
  collapse = function(begin, block) {
    var i, lines, n, _i;
    n = numlines(block);
    lines = $('ol.linenums li', block);
    if (block.hasClass('collapsable')) {
      block.addClass('collapsed');
      for (i = _i = begin; begin <= n ? _i <= n : _i >= n; i = begin <= n ? ++_i : --_i) {
        $(lines[i]).addClass('hidden');
      }
      $("li.ellipsis", block).removeClass('hidden');
    }
  };
  expand = function(block) {
    block.removeClass('collapsed');
    $('ol.linenums li', block).removeClass('hidden');
    $("li.ellipsis", block).addClass('hidden');
  };
  prettyPrint();
  codeblocks = $('.prettyprint.linenums');
  for (_i = 0, _len = codeblocks.length; _i < _len; _i++) {
    block = codeblocks[_i];
    if (numlines($(block)) > keep) {
      prepareblock($(block));
    }
  }
  codeblocks.click(function() {
    block = $(this);
    if (block.hasClass('collapsed')) {
      expand(block);
    } else {
      collapse(keep, block);
    }
  });
});
